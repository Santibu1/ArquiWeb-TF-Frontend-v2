<div class="container">
    <div class="header-section">
        <button class="back-button" [routerLink]="['/admin']">
            <mat-icon>arrow_back</mat-icon>
            <span>Volver al Menú</span>
        </button>
        <h1>Gestionar Usuarios</h1>
    </div>

    <div class="content-section">

        <div class="filter-controls">
            <mat-form-field appearance="outline">
                <mat-label>Filtrar por Rol</mat-label>
                <mat-select [(ngModel)]="rolSeleccionado" (selectionChange)="filtrarPorRol()">
                    <mat-option value="TODOS">Todos</mat-option>
                    <mat-option value="MODERADOR">Moderadores</mat-option>
                    <mat-option value="CLIENTE">Clientes</mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="mat-elevation-z8">

            <table mat-table [dataSource]="dataSource" matSort>
                <!-----NUEVO PARA REACTIVACIÓN DE USUARIO---->
                <ng-container matColumnDef="acciones">
                    <th mat-header-cell *matHeaderCellDef> Acciones </th>
                    <td mat-cell *matCellDef="let element">
                        <!-- SUSPENDER -->
                        <button *ngIf="element.estado.toUpperCase() === 'ACTIVO'"
                                mat-icon-button color="warn"
                                (click)="suspenderUsuario(element.usuarioId)"
                                matTooltip="Suspender usuario">
                            <mat-icon>block</mat-icon>
                        </button>

                        <!-- REACTIVAR -->
                        <button *ngIf="element.estado.toUpperCase() === 'DESACTIVADO'"
                                mat-icon-button color="primary"
                                (click)="reactivarUsuario(element.usuarioId)"
                                matTooltip="Reactivar usuario">
                            <mat-icon>restore</mat-icon>
                        </button>
                    </td>
                </ng-container>


                <ng-container matColumnDef="usuarioId">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                    <td mat-cell *matCellDef="let element"> {{element.usuarioId}} </td>
                </ng-container>

                <ng-container matColumnDef="nombreUsuario">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </th>
                    <td mat-cell *matCellDef="let element"> {{element.nombreUsuario}} </td>
                </ng-container>

                <ng-container matColumnDef="apellidoUsuario">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Apellido </th>
                    <td mat-cell *matCellDef="let element"> {{element.apellidoUsuario}} </td>
                </ng-container>

                <ng-container matColumnDef="emailUsuario">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Correo </th>
                    <td mat-cell *matCellDef="let element"> {{element.emailUsuario}} </td>
                </ng-container>

                <ng-container matColumnDef="edadUsuario">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Edad </th>
                    <td mat-cell *matCellDef="let element"> {{element.edadUsuario}} </td>
                </ng-container>

                <ng-container matColumnDef="ecobits">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Ecobits </th>
                    <td mat-cell *matCellDef="let element"> {{element.ecobits}} </td>
                </ng-container>

                <ng-container matColumnDef="rolId">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Rol </th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.rolId === 2 ? 'MODERADOR' : element.rolId === 3 ? 'CLIENTE' : 'DESCONOCIDO' }}
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            </table>

            <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>

        </div>
    </div>
</div>
