<app-sub-navbar-usuario></app-sub-navbar-usuario>

<div class="eco-container">

    <!-- TÃTULO GENERAL -->
    <h1 class="eco-title">ðŸŒ¿ Reportes del mes</h1>

    <!-- âœ“ TARJETAS DE INDICADORES -->
    <div class="eco-kpi-row">

        <!-- Meses registrados -->
        <div class="eco-kpi-card">
            <h2>{{ totalMeses }}</h2>
            <p>Meses registrados</p>
        </div>

        <!-- Puntos totales -->
        <div class="eco-kpi-card">
            <h2>{{ totalPuntos }}</h2>
            <p>Puntos totales</p>
        </div>

        <!-- Estado IA -->
        <div class="eco-kpi-card">
            <h2>{{ cargandoIA ? "â€¦" : "âœ”" }}</h2>
            <p>AnÃ¡lisis IA</p>
        </div>

    </div>

    <!-- GRID PRINCIPAL -->
    <div class="eco-grid">

        <!-- ============================ -->
        <!--      ðŸ“Š GRÃFICO BARRAS        -->
        <!-- ============================ -->
        <div class="eco-card eco-chart-card">
            <h3 class="eco-card-title">ðŸ“Š Puntos obtenidos</h3>

            <div class="eco-chart-wrapper">
                <canvas baseChart
                        [datasets]="barChartData"
                        [labels]="barChartLabels"
                        [options]="barChartOptions"
                        type="bar">
                </canvas>
            </div>
        </div>

        <!-- ============================ -->
        <!--     âœ¨ ANÃLISIS ECO IA        -->
        <!-- ============================ -->
        <div class="eco-card eco-ai-card">
            <h3 class="eco-card-title">âœ¨ AnÃ¡lisis Eco-Inteligente</h3>

            <div class="eco-ai-content" [class.cargando]="cargandoIA">

                <!-- LOADING -->
                <ng-container *ngIf="cargandoIA">
                    <div class="eco-loader"></div>
                    <p class="eco-loading-text">Generando anÃ¡lisis ecolÃ³gicoâ€¦</p>
                </ng-container>

                <!-- TEXTO IA -->
                <ng-container *ngIf="!cargandoIA">
                    <div class="eco-ai-text" [innerHTML]="recomendacionIA"></div>
                </ng-container>

            </div>

            <button class="eco-button"
                    (click)="escucharAnalisis()"
                    [disabled]="cargandoIA">
                ðŸ”Š Escuchar anÃ¡lisis
            </button>
        </div>

    </div>
</div>
